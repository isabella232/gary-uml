@startuml

header
Terminal Classes (GWT)
endheader

interface WorkbenchView {
   bringToFront()
   ensureHeight(int)
   maximize()
   onBeforeSelected()
   onBeforeUnselected()
   onSelected()
   setProgress(boolean)
}

class DelayLoadWorkbenchTab<T>

class TerminalTab <TerminalTabPresenter> <<singleton>> {
   + closeable() : boolean
   + confirmClose(Command)
}
DelayLoadWorkbenchTab <|-- TerminalTab

abstract class BasePresenter {
   + asWidget() : Widget
   + getView() : WorkbenchView
   + onBeforeSelected()
   + onBeforeUnselected()
   + onSelected()
}

class TerminalTabPresenter {
   + confirmClose(Command)
   + onRepopulateTerminals(ArrayList<ConsoleProcessInfo>)
   .. Event Handlers ..
   + onActivateNamedTerminal(ActivateNamedTerminalEvent)
   + onAddToTerminal(AddToTerminalEvent)
   + onClearTerminal(ClearTerminalEvent)
   + onCreateTerminal(CreateTerminalEvent)
   + onRemoveTerminal(RemoveTerminalEvent)
   + onSendToTerminal(SendToTerminalEvent)
   .. Command Handlers ..
   + onActivateTerminal()
   + onClearTerminalScrollbackBuffer()
   + onCloseTerminal()
   + onInterruptTerminal()
   + onNextTerminal()
   + onPreviousTerminal()
   + onRenameTerminal() 
   + onSendTerminalToEditor()
   + onShowTerminalInfo()
}

BasePresenter <|-- TerminalTabPresenter

interface DisplaySelectedCallback {
   displaySelected()
}

interface TerminalTabPresenter.Display {
   activateNamedTerminal(caption, createdByApi)
   activateTerminal(DisplaySelectedCallback)
   activeTerminals() : boolean
   addTerminal(ConsoleProcessInfo, hasSession)
   clearTerminalScrollbackBuffer(caption)
   createTerminal(postCreateText)
   ensureTerminal()
   interruptTerminal()
   nextTerminal()
   previousTerminal()
   removeTerminal(handle)
   renameTerminal()
   repopulateTerminals(ArrayList<ConsoleProcessInfo>)
   sendTerminalToEditor()
   sendToTerminal(text, setFocus)
   showTerminalInfo()
   terminateAllTerminals()
   terminateCurrentTerminal()
}

class XTermNative <<JavaScriptObject>>
class Widget
class XTermWidget
class TerminalSession

class TerminalHelper <<singleton>> {
    + warnBeforeClosing(busyMode) : boolean
    + warnBusyTerminalBeforeCommand(Command, ...)
}

class TerminalTab.Shim <<generated>> {
   ~ onRepopulateTerminals(ArrayList<ConsoleProcessInfo>)
   ~ confirmClose(Command)
   .. Event Handlers ..
   + onActivateNamedTerminal(ActivateNamedTerminalEvent)
   + onAddTerminal(AddTerminalEvent)
   + onClearTerminal(ClearTerminalEvent)
   + onCreateTerminal(CreateTerminalEvent)
   + onRemoveTerminal(RemoveTerminalEvent)
   + onSendToTerminal(SendToTerminalEvent)
   .. Command Handlers ..
   + onActivateTerminal()
   + onClearTerminalScrollbackBuffer()
   + onCloseTerminal()
   + onInterruptTerminal()
   + onNextTerminal()
   + onPreviousTerminal()
   + onRenameTerminal()
   + onSendTerminalToEditor()
   + onShowTerminalInfo()
}

class ToolbarPane {
   + bringToFront()
   + ensureHeight(int)
   + maximize()
   + setProgress(boolean)
}

abstract class WorkbenchPane {
   + closable() : boolean
   + confirmClose(Command)
   + getTitle() : String
   + isSuppressed() : boolean
   + onBeforeSelected()
   + onBeforeUnselected()
   + onSelected()
   + prefetch(Command)
}
ToolbarPane <|-- WorkbenchPane

class TerminalPane {
   # createMainWidget() : Widget
   # createMainToolbar() : Toolbar
   .. Event Handlers ..
   + onTerminalSessionStarted(TerminalSessionStartedEvent)
   + onTerminalSessionStopped(TerminalSessionStoppedEvent)
   + onServerProcessExit(ServerProcessExitEvent)
   + onSwitchToTerminal(SwitchToTerminalEvent)
   + onTerminalTitle(TerminalTitleEvent)
   + onSessionSerialization(SessionSerializationEvent)
   + onTerminalSubproc(TerminalSubprocEvent)
}

TerminalTabPresenter.Display <|.. TerminalPane
TerminalTabPresenter ..> TerminalTabPresenter.Display : <<use>>
TerminalTabPresenter ..> TerminalHelper : <<use>>

interface WorkbenchTab {
   closeable() : boolean
   confirmClose(Command)
   getTitle() : String
   isSuppressed() : boolean
   onBeforeSelected()
   onBeforeUnselected()
   onSelected()
   prefetch(Command continuation)
}

WorkbenchView <|.. WorkbenchPane
WorkbenchTab <|.. WorkbenchPane
WorkbenchPane <|-- TerminalPane

class DeckLayoutPanel
class TerminalPopupMenu
class TerminalList

TerminalPane *-- "1" DeckLayoutPanel
TerminalPane *-- "1" TerminalPopupMenu
TerminalPane *-- "1" TerminalList

XTermWidget <|-- TerminalSession
Widget <|-- XTermWidget
XTermWidget *-- "1" XTermNative
WorkbenchView <|.. TerminalTabPresenter.Display
TerminalTab *-- "1" TerminalTab.Shim
TerminalTab.Shim *-- "1" TerminalTabPresenter
TerminalPopupMenu ..> TerminalList : <<use>>
DeckLayoutPanel o-- "0..*" TerminalSession
TerminalList *-- "0..*" TerminalSession

hide members

@enduml

